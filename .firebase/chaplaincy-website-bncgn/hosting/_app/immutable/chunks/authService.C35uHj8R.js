import{h as l,f as n,b as i,d as c,c as d,s as g}from"./firebaseConfig.C3ZSizqS.js";import{u as m,a as t}from"./AuthStore.NrCGm6q_.js";import{s as f,c as h,u as p}from"./index-219c3cac.BQwdOHZI.js";async function y(e,a){let r=l(n,"setUserRole");console.log({uid:e,role:a}),r({uid:e,role:a}).then(s=>{console.log("After role assignment: ",s)}).catch(s=>{console.log(s.message)})}const U=l(n,"listUsers"),A=async()=>{try{return(await U()).data.users}catch(e){console.error("Error listing users:",e)}};async function N(e){try{return await l(n,"getUserProfile")({uid:e}).then(r=>r.data.user).catch(r=>{throw console.log(r.message),r})}catch(a){throw console.log("Error: ",a.message),a}}async function w(e){return e.getIdTokenResult().then(a=>a.claims.role)}async function R(e,a){await m();try{t.update(u=>({...u,loading:!0,error:null}));const s=(await f(i,e,a)).user,o=await w(s);return t.set({...t,user:s,name:s.displayName,loading:!1,error:null,isLoggedIn:!0,role:o}),s}catch(r){t.update(s=>({...s,loading:!1,error:r.message,isLoggedIn:!1})),console.log("Error: ",r.message)}}async function C(e,a){try{t.update(o=>({...o,loading:!0,error:null}));const s=(await h(i,e.email,a)).user;p(s,{displayName:e.displayName}),await y(s.uid,"user");try{const o=c(d,"users",s.uid);await g(o,{firstname:e.firstname,lastname:e.lastname,email:e.email,displayName:e.displayName},{merge:!0})}catch(o){console.log("Error: ",o.message)}return t.set({...t,user:s,name:s.displayName,role:"user",loading:!1,error:null,isLoggedIn:!0}),s}catch(r){throw console.log("Error: ",r.code),t.update(s=>({...s,loading:!1,error:r.message,isLoggedIn:!1})),r}}async function L(e){try{return await l(n,"updateUserProfile")(e).then(r=>r).catch(r=>{throw console.log(r.message),r})}catch(a){throw console.log("Error: ",a.message),a}}export{w as a,N as g,A as l,C as r,R as s,L as u};
